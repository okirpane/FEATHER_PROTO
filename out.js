(()=>{var we=Object.create;var M=Object.defineProperty;var Se=Object.getOwnPropertyDescriptor;var Ue=Object.getOwnPropertyNames;var Pe=Object.getPrototypeOf,Le=Object.prototype.hasOwnProperty;var Fe=v=>M(v,"__esModule",{value:!0});var Xe=(v,m)=>()=>(m||v((m={exports:{}}).exports,m),m.exports);var De=(v,m,b)=>{if(m&&typeof m=="object"||typeof m=="function")for(let _ of Ue(m))!Le.call(v,_)&&_!=="default"&&M(v,_,{get:()=>m[_],enumerable:!(b=Se(m,_))||b.enumerable});return v},Me=v=>De(Fe(M(v!=null?we(Pe(v)):{},"default",v&&v.__esModule&&"default"in v?{get:()=>v.default,enumerable:!0}:{value:v,enumerable:!0})),v);var Y=Xe((C,I)=>{(function(v,m){typeof C=="object"&&typeof I!="undefined"?I.exports=m():typeof define=="function"&&define.amd?define(m):v.GlslCanvas=m()})(C,function(){"use strict";var v=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function m(n,a){return a={exports:{}},n(a,a.exports),a.exports}var b;typeof window!="undefined"?b=window:typeof v!="undefined"?b=v:typeof self!="undefined"?b=self:b={};var _=b,B=J,$=Object.prototype.toString;function J(n){var a=$.call(n);return a==="[object Function]"||typeof n=="function"&&a!=="[object RegExp]"||typeof window!="undefined"&&(n===window.setTimeout||n===window.alert||n===window.confirm||n===window.prompt)}var P=m(function(n,a){a=n.exports=t;function t(r){return r.replace(/^\s*|\s*$/g,"")}a.left=function(r){return r.replace(/^\s*/,"")},a.right=function(r){return r.replace(/\s*$/,"")}}),K=ee,Z=Object.prototype.toString,G=Object.prototype.hasOwnProperty;function ee(n,a,t){if(!B(a))throw new TypeError("iterator must be a function");arguments.length<3&&(t=this),Z.call(n)==="[object Array]"?te(n,a,t):typeof n=="string"?re(n,a,t):ie(n,a,t)}function te(n,a,t){for(var r=0,e=n.length;r<e;r++)G.call(n,r)&&a.call(t,n[r],r,n)}function re(n,a,t){for(var r=0,e=n.length;r<e;r++)a.call(t,n.charAt(r),r,n)}function ie(n,a,t){for(var r in n)G.call(n,r)&&a.call(t,n[r],r,n)}var ne=function(n){return Object.prototype.toString.call(n)==="[object Array]"},ae=function(n){if(!n)return{};var a={};return K(P(n).split(`
`),function(t){var r=t.indexOf(":"),e=P(t.slice(0,r)).toLowerCase(),i=P(t.slice(r+1));typeof a[e]=="undefined"?a[e]=i:ne(a[e])?a[e].push(i):a[e]=[a[e],i]}),a},se=ue,oe=Object.prototype.hasOwnProperty;function ue(){for(var n={},a=0;a<arguments.length;a++){var t=arguments[a];for(var r in t)oe.call(t,r)&&(n[r]=t[r])}return n}var L=y,le=y;y.XMLHttpRequest=_.XMLHttpRequest||ce,y.XDomainRequest="withCredentials"in new y.XMLHttpRequest?y.XMLHttpRequest:_.XDomainRequest,fe(["get","put","post","patch","head","delete"],function(n){y[n==="delete"?"del":n]=function(a,t,r){return t=N(a,t,r),t.method=n.toUpperCase(),O(t)}});function fe(n,a){for(var t=0;t<n.length;t++)a(n[t])}function he(n){for(var a in n)if(n.hasOwnProperty(a))return!1;return!0}function N(n,a,t){var r=n;return B(a)?(t=a,typeof n=="string"&&(r={uri:n})):r=se(a,{uri:n}),r.callback=t,r}function y(n,a,t){return a=N(n,a,t),O(a)}function O(n){if(typeof n.callback=="undefined")throw new Error("callback argument missing");var a=!1,t=function(x,U,Ae){a||(a=!0,n.callback(x,U,Ae))};function r(){s.readyState===4&&setTimeout(o,0)}function e(){var g=void 0;if(s.response?g=s.response:g=s.responseText||de(s),E)try{g=JSON.parse(g)}catch(x){}return g}function i(g){return clearTimeout(p),g instanceof Error||(g=new Error(""+(g||"Unknown XMLHttpRequest Error"))),g.statusCode=0,t(g,R)}function o(){if(!l){var g;clearTimeout(p),n.useXDR&&s.status===void 0?g=200:g=s.status===1223?204:s.status;var x=R,U=null;return g!==0?(x={body:e(),statusCode:g,method:f,headers:{},url:h,rawRequest:s},s.getAllResponseHeaders&&(x.headers=ae(s.getAllResponseHeaders()))):U=new Error("Internal XMLHttpRequest Error"),t(U,x,x.body)}}var s=n.xhr||null;s||(n.cors||n.useXDR?s=new y.XDomainRequest:s=new y.XMLHttpRequest);var u,l,h=s.url=n.uri||n.url,f=s.method=n.method||"GET",d=n.body||n.data,c=s.headers=n.headers||{},T=!!n.sync,E=!1,p,R={body:void 0,headers:{},statusCode:0,method:f,url:h,rawRequest:s};if("json"in n&&n.json!==!1&&(E=!0,c.accept||c.Accept||(c.Accept="application/json"),f!=="GET"&&f!=="HEAD"&&(c["content-type"]||c["Content-Type"]||(c["Content-Type"]="application/json"),d=JSON.stringify(n.json===!0?d:n.json))),s.onreadystatechange=r,s.onload=o,s.onerror=i,s.onprogress=function(){},s.onabort=function(){l=!0},s.ontimeout=i,s.open(f,h,!T,n.username,n.password),T||(s.withCredentials=!!n.withCredentials),!T&&n.timeout>0&&(p=setTimeout(function(){if(!l){l=!0,s.abort("timeout");var g=new Error("XMLHttpRequest timeout");g.code="ETIMEDOUT",i(g)}},n.timeout)),s.setRequestHeader)for(u in c)c.hasOwnProperty(u)&&s.setRequestHeader(u,c[u]);else if(n.headers&&!he(n.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in n&&(s.responseType=n.responseType),"beforeSend"in n&&typeof n.beforeSend=="function"&&n.beforeSend(s),s.send(d||null),s}function de(n){try{if(n.responseType==="document")return n.responseXML;var a=n.responseXML&&n.responseXML.documentElement.nodeName==="parsererror";if(n.responseType===""&&!a)return n.responseXML}catch(t){}return null}function ce(){}L.default=le;var S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Be=function(){function n(t){this.value=t}function a(t){var r,e;function i(u,l){return new Promise(function(h,f){var d={key:u,arg:l,resolve:h,reject:f,next:null};e?e=e.next=d:(r=e=d,o(u,l))})}function o(u,l){try{var h=t[u](l),f=h.value;f instanceof n?Promise.resolve(f.value).then(function(d){o("next",d)},function(d){o("throw",d)}):s(h.done?"return":"normal",h.value)}catch(d){s("throw",d)}}function s(u,l){switch(u){case"return":r.resolve({value:l,done:!0});break;case"throw":r.reject(l);break;default:r.resolve({value:l,done:!1});break}r=r.next,r?o(r.key,r.arg):e=null}this._invoke=i,typeof t.return!="function"&&(this.return=void 0)}return typeof Symbol=="function"&&Symbol.asyncIterator&&(a.prototype[Symbol.asyncIterator]=function(){return this}),a.prototype.next=function(t){return this._invoke("next",t)},a.prototype.throw=function(t){return this._invoke("throw",t)},a.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new a(t.apply(this,arguments))}},await:function(t){return new n(t)}}}(),k=function(n,a){if(!(n instanceof a))throw new TypeError("Cannot call a class as a function")},H=function(){function n(a,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(a,e.key,e)}}return function(a,t,r){return t&&n(a.prototype,t),r&&n(a,r),a}}(),F=function(n){if(Array.isArray(n)){for(var a=0,t=Array(n.length);a<n.length;a++)t[a]=n[a];return t}else return Array.from(n)},w="";function ge(n){return`
<table style="background-color: #8CE; width: 100%; height: 100%;"><tr>
<td align="center">
<div style="display: table-cell; vertical-align: middle;">
<div style="">`+n+`</div>
</div>
</td></tr></table>
`}var ve=`
	This page requires a browser that supports WebGL.<br/>
	<a href="http://get.webgl.org">Click here to upgrade your browser.</a>
`,me=`
	It does not appear your computer can support WebGL.<br/>
	<a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>
`,Ee=1,Te=2;function pe(n,a,t){function r(o){var s=n.parentNode;s&&(s.innerHTML=ge(o))}function e(o,s){typeof t=="function"?t(o):r(s)}if(!window.WebGLRenderingContext)return e(Ee,ve),null;var i=Re(n,a);return i?i.getExtension("OES_standard_derivatives"):e(Te,me),i}function Re(n,a){for(var t=["webgl","experimental-webgl"],r=null,e=0;e<t.length;++e)try{r=n.getContext(t[e],a)}catch(i){if(r)break}return r}function A(n,a,t,r){var e=n.gl,i=e.createShader(t);e.shaderSource(i,a),e.compileShader(i);var o=e.getShaderParameter(i,e.COMPILE_STATUS);return o?i:(w=e.getShaderInfoLog(i),console.error("*** Error compiling shader "+i+":"+w),n.trigger("error",{shader:i,source:a,type:t,error:w,offset:r||0}),e.deleteShader(i),null)}function j(n,a,t,r){for(var e=n.gl,i=e.createProgram(),o=0;o<a.length;++o)e.attachShader(i,a[o]);if(t)for(var s=0;s<t.length;++s)e.bindAttribLocation(i,r?r[s]:s,t[s]);e.linkProgram(i);var u=e.getProgramParameter(i,e.LINK_STATUS);return u?i:(w=e.getProgramInfoLog(i),console.log("Error in program linking:"+w),e.deleteProgram(i),null)}function X(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=[];for(var r in n){var e=n[r],i=void 0;if(a&&(r=a+"."+r),typeof e=="number")t.push({type:"float",method:"1f",name:r,value:e});else if(Array.isArray(e)){if(typeof e[0]=="number")e.length===1?t.push({type:"float",method:"1f",name:r,value:e}):e.length>=2&&e.length<=4?t.push({type:"vec"+e.length,method:e.length+"fv",name:r,value:e}):e.length>4&&t.push({type:"float[]",method:"1fv",name:r+"[0]",value:e});else if(typeof e[0]=="string")t.push({type:"sampler2D",method:"1i",name:r,value:e});else if(Array.isArray(e[0])&&typeof e[0][0]=="number"){if(e[0].length>=2&&e[0].length<=4)for(i=0;i<e.length;i++)t.push({type:"vec"+e[0].length,method:e[i].length+"fv",name:r+"["+i+"]",value:e[i]})}else if(S(e[0])==="object")for(i=0;i<e.length;i++)t.push.apply(t,F(X(e[i],r+"["+i+"]")))}else typeof e=="boolean"?t.push({type:"bool",method:"1i",name:r,value:e}):typeof e=="string"?t.push({type:"sampler2D",method:"1i",name:r,value:e}):(typeof e=="undefined"?"undefined":S(e))==="object"&&t.push.apply(t,F(X(e,r)))}return t}function ye(n){return n.getBoundingClientRect().top+n.height>0&&n.getBoundingClientRect().top<(window.innerHeight||document.documentElement.clientHeight)}function W(n){return(n&n-1)==0}function be(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function _e(n,a){return n&&a?n.toString()!==a.toString():!1}function q(n){var a=new Set;return Object.assign(n,{on:function(r,e){var i={};i[r]=e,a.add(i)},off:function(r,e){if(e){var i={};i[r]=e,a.delete(i)}else{var o=!0,s=!1,u=void 0;try{for(var l=a[Symbol.iterator](),h;!(o=(h=l.next()).done);o=!0){var f=h.value,d=!0,c=!1,T=void 0;try{for(var E=Object.keys(f)[Symbol.iterator](),p;!(d=(p=E.next()).done);d=!0){var R=p.value;if(R===r){a.delete(f);return}}}catch(g){c=!0,T=g}finally{try{!d&&E.return&&E.return()}finally{if(c)throw T}}}}catch(g){s=!0,u=g}finally{try{!o&&l.return&&l.return()}finally{if(s)throw u}}}},listSubscriptions:function(){var r=!0,e=!1,i=void 0;try{for(var o=a[Symbol.iterator](),s;!(r=(s=o.next()).done);r=!0){var u=s.value;console.log(u)}}catch(l){e=!0,i=l}finally{try{!r&&o.return&&o.return()}finally{if(e)throw i}}},subscribe:function(r){a.add(r)},unsubscribe:function(r){a.delete(r)},unsubscribeAll:function(){a.clear()},trigger:function(r){for(var e=arguments.length,i=Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];var s=!0,u=!1,l=void 0;try{for(var h=a[Symbol.iterator](),f;!(s=(f=h.next()).done);s=!0){var d=f.value;typeof d[r]=="function"&&d[r].apply(d,F(i))}}catch(c){u=!0,l=c}finally{try{!s&&h.return&&h.return()}finally{if(u)throw l}}}})}var D=function(){function n(a,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};k(this,n),q(this),this.gl=a,this.texture=a.createTexture(),this.texture&&(this.valid=!0),this.bind(),this.name=t,this.source=null,this.sourceType=null,this.loading=null,this.setData(1,1,new Uint8Array([0,0,0,255]),{filtering:"linear"}),this.setFiltering(r.filtering),this.load(r)}return H(n,[{key:"destroy",value:function(){!this.valid||(this.gl.deleteTexture(this.texture),this.texture=null,delete this.data,this.data=null,this.valid=!1)}},{key:"bind",value:function(t){!this.valid||(typeof t=="number"&&n.activeUnit!==t&&(this.gl.activeTexture(this.gl.TEXTURE0+t),n.activeUnit=t),n.activeTexture!==this.texture&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),n.activeTexture=this.texture))}},{key:"load",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.loading=null,typeof t.url=="string"?(this.url===void 0||t.url!==this.url)&&this.setUrl(t.url,t):t.element?this.setElement(t.element,t):t.data&&t.width&&t.height&&this.setData(t.width,t.height,t.data,t)}},{key:"setUrl",value:function(t){var r=this,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!!this.valid)return this.url=t,this.source=this.url,this.sourceType="url",this.loading=new Promise(function(i,o){var s=t.split(".").pop().toLowerCase(),u=s==="ogv"||s==="webm"||s==="mp4",l=void 0;u?(l=document.createElement("video"),l.autoplay=!0,e.filtering="nearest"):l=new Image,l.onload=function(){try{r.setElement(l,e)}catch(h){console.log("Texture '"+r.name+"': failed to load url: '"+r.source+"'",h,e)}i(r)},l.onerror=function(h){console.log("Texture '"+r.name+"': failed to load url: '"+r.source+"'",h,e),i(r)},be()&&r.source.slice(0,5)==="data:"||(l.crossOrigin="anonymous"),l.src=r.source,u&&r.setElement(l,e)}),this.loading}},{key:"setData",value:function(t,r,e){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.width=t,this.height=r,this.source=e,this.sourceType="data",this.update(i),this.setFiltering(i),this.loading=Promise.resolve(this),this.loading}},{key:"setElement",value:function(t,r){var e=this,i=t;if(typeof t=="string"&&(t=document.querySelector(t)),t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement)this.source=t,this.sourceType="element",t instanceof HTMLVideoElement?(t.addEventListener("canplaythrough",function(){e.intervalID=setInterval(function(){e.update(r)},15)},!0),t.addEventListener("ended",function(){t.currentTime=0,t.play()},!0)):this.update(r),this.setFiltering(r);else{var o="the 'element' parameter (`element: "+JSON.stringify(i)+"`) must be a CSS ";o+="selector string, or a <canvas>, <image> or <video> object",console.log("Texture '"+this.name+"': "+o,r)}return this.loading=Promise.resolve(this),this.loading}},{key:"update",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};!this.valid||(this.bind(),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,t.UNPACK_FLIP_Y_WEBGL!==!1),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.UNPACK_PREMULTIPLY_ALPHA_WEBGL||!1),this.sourceType==="element"&&(this.source instanceof HTMLCanvasElement||this.source instanceof HTMLVideoElement||this.source instanceof HTMLImageElement&&this.source.complete)?(this.source instanceof HTMLVideoElement?(this.width=this.source.videoWidth,this.height=this.source.videoHeight):(this.width=this.source.width,this.height=this.source.height),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.source)):this.sourceType==="data"&&this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.source),this.trigger("loaded",this))}},{key:"setFiltering",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!!this.valid){this.powerOf2=W(this.width)&&W(this.height);var r=this.powerOf2?"mipmap":"linear";this.filtering=t.filtering||r;var e=this.gl;this.bind(),this.powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,t.TEXTURE_WRAP_S||t.repeat&&e.REPEAT||e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,t.TEXTURE_WRAP_T||t.repeat&&e.REPEAT||e.CLAMP_TO_EDGE),this.filtering==="mipmap"?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.generateMipmap(e.TEXTURE_2D)):this.filtering==="linear"?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)):this.filtering==="nearest"&&(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST))):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),this.filtering==="mipmap"&&(this.filtering="linear"),this.filtering==="nearest"?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)))}}}]),n}();D.getMaxTextureSize=function(n){return n.getParameter(n.MAX_TEXTURE_SIZE)},D.activeUnit=-1;var V=function(){function n(a,t,r){var e=this;k(this,n),q(this),t=t||{},r=r||{},a.hasAttribute("data-fullscreen")&&(a.getAttribute("data-fullscreen")=="1"||a.getAttribute("data-fullscreen")=="true")?(this.width=window.innerWidth,this.height=window.innerHeight,a.width=window.innerWidth,a.height=window.innerHeight):(this.width=a.clientWidth,this.height=a.clientHeight),this.canvas=a,this.gl=void 0,this.program=void 0,this.textures={},this.buffers={},this.uniforms={},this.vbo={},this.isValid=!1,this.animationFrameRequest=void 0,this.BUFFER_COUNT=0,this.vertexString=t.vertexString||`
#ifdef GL_ES
precision mediump float;
#endif

attribute vec2 a_position;
attribute vec2 a_texcoord;

varying vec2 v_texcoord;

void main() {
    gl_Position = vec4(a_position, 0.0, 1.0);
    v_texcoord = a_texcoord;
}
`,this.fragmentString=t.fragmentString||`
#ifdef GL_ES
precision mediump float;
#endif

varying vec2 v_texcoord;

void main(){
    gl_FragColor = vec4(0.0);
}
`;var i=pe(a,t,r.onError);if(!i)return;if(this.gl=i,this.timeLoad=this.timePrev=performance.now(),this.timeDelta=0,this.forceRender=!0,this.paused=!1,this.realToCSSPixels=window.devicePixelRatio||1,a.style.backgroundColor=t.backgroundColor||"rgba(1,1,1,0)",a.hasAttribute("data-fragment"))this.fragmentString=a.getAttribute("data-fragment");else if(a.hasAttribute("data-fragment-url")){var o=a.getAttribute("data-fragment-url");L.get(o,function(E,p,R){e.load(R,e.vertexString)})}if(a.hasAttribute("data-vertex"))this.vertexString=a.getAttribute("data-vertex");else if(a.hasAttribute("data-vertex-url")){var s=a.getAttribute("data-vertex-url");L.get(s,function(E,p,R){e.load(e.fragmentString,R)})}if(this.load(),!this.program)return;var u=i.getAttribLocation(this.program,"a_texcoord");this.vbo.texCoords=i.createBuffer(),this.gl.bindBuffer(i.ARRAY_BUFFER,this.vbo.texCoords),this.gl.bufferData(i.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),i.STATIC_DRAW),this.gl.enableVertexAttribArray(u),this.gl.vertexAttribPointer(u,2,i.FLOAT,!1,0,0);var l=i.getAttribLocation(this.program,"a_position");if(this.vbo.vertices=i.createBuffer(),this.gl.bindBuffer(i.ARRAY_BUFFER,this.vbo.vertices),this.gl.bufferData(i.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),i.STATIC_DRAW),this.gl.enableVertexAttribArray(l),this.gl.vertexAttribPointer(l,2,i.FLOAT,!1,0,0),a.hasAttribute("data-textures")){var h=a.getAttribute("data-textures").split(",");for(var f in h)this.setUniform("u_tex"+f,h[f])}var d={x:0,y:0};document.addEventListener("mousemove",function(E){d.x=E.clientX||E.pageX,d.y=E.clientY||E.pageY},!1);var c=this;function T(){c.nMouse>1&&c.setMouse(d),c.resize()&&(c.forceRender=!0),c.render(),c.animationFrameRequest=window.requestAnimationFrame(T)}return this.setMouse({x:0,y:0}),T(),this}return H(n,[{key:"destroy",value:function(){cancelAnimationFrame(this.animationFrameRequest),this.animated=!1,this.isValid=!1;for(var t in this.textures)t.destroy&&t.destroy();this.textures={};for(var r in this.attribs)this.gl.deleteBuffer(this.attribs[r]);this.gl.useProgram(null),this.gl.deleteProgram(this.program);for(var e in this.buffers){var i=this.buffers[e];this.gl.deleteProgram(i.program)}this.program=null,this.gl=null}},{key:"load",value:function(t,r){r&&(this.vertexString=r),t&&(this.fragmentString=t),this.animated=!1,this.nDelta=(this.fragmentString.match(/u_delta/g)||[]).length,this.nTime=(this.fragmentString.match(/u_time/g)||[]).length,this.nDate=(this.fragmentString.match(/u_date/g)||[]).length,this.nMouse=(this.fragmentString.match(/u_mouse/g)||[]).length,this.animated=this.nDate>1||this.nTime>1||this.nMouse>1;var e=this.fragmentString.search(/sampler2D/g);if(e)for(var i=this.fragmentString.split(`
`),o=0;o<i.length;o++){var s=i[o].match(/uniform\s*sampler2D\s*([\w]*);\s*\/\/\s*([\w|\:\/\/|\.|\-|\_]*)/i);if(s){var u=s[2].split(".").pop().toLowerCase();s[1]&&s[2]&&(u==="jpg"||u==="jpeg"||u==="png"||u==="ogv"||u==="webm"||u==="mp4")&&this.setUniform(s[1],s[2])}var l=i[o].match(/\s*void\s*main\s*/g);if(l)break}var h=A(this,this.vertexString,this.gl.VERTEX_SHADER),f=A(this,this.fragmentString,this.gl.FRAGMENT_SHADER);f?this.isValid=!0:(f=A(this,`void main(){
	gl_FragColor = vec4(1.0);
}`,this.gl.FRAGMENT_SHADER),this.isValid=!1);var d=j(this,[h,f]);this.gl.useProgram(d),this.gl.deleteShader(h),this.gl.deleteShader(f),this.program=d,this.change=!0,this.BUFFER_COUNT=0;var c=this.getBuffers(this.fragmentString);Object.keys(c).length&&this.loadPrograms(c),this.buffers=c,this.texureIndex=this.BUFFER_COUNT,this.trigger("load",{}),this.forceRender=!0,this.render()}},{key:"test",value:function(t,r,e){var i=this.vertexString,o=this.fragmentString,s=this.paused,u=this.gl.getExtension("EXT_disjoint_timer_query"),l=u.createQueryEXT(),h=this.isValid;(r||e)&&(this.load(r,e),h=this.isValid,this.forceRender=!0,this.render()),this.paused=!0,u.beginQueryEXT(u.TIME_ELAPSED_EXT,l),this.forceRender=!0,this.render(),u.endQueryEXT(u.TIME_ELAPSED_EXT);var f=this;function d(){f.paused=s,(r||e)&&f.load(o,i)}function c(){f.forceRender=!0,f.render();var T=u.getQueryObjectEXT(l,u.QUERY_RESULT_AVAILABLE_EXT),E=f.gl.getParameter(u.GPU_DISJOINT_EXT);if(T&&!E){var p={wasValid:h,frag:r||f.fragmentString,vert:e||f.vertexString,timeElapsedMs:u.getQueryObjectEXT(l,u.QUERY_RESULT_EXT)/1e6};d(),t(p)}else window.requestAnimationFrame(c)}c()}},{key:"loadTexture",value:function(t,r,e){var i=this;e||(e={}),typeof r=="string"?e.url=r:(typeof r=="undefined"?"undefined":S(r))==="object"&&r.data&&r.width&&r.height?(e.data=r.data,e.width=r.width,e.height=r.height):(typeof r=="undefined"?"undefined":S(r))==="object"&&(e.element=r),this.textures[t]?this.textures[t]&&(this.textures[t].load(e),this.textures[t].on("loaded",function(o){i.forceRender=!0})):(this.textures[t]=new D(this.gl,t,e),this.textures[t].on("loaded",function(o){i.forceRender=!0}))}},{key:"refreshUniforms",value:function(){this.uniforms={}}},{key:"setUniform",value:function(t){for(var r={},e=arguments.length,i=Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];r[t]=i,this.setUniforms(r)}},{key:"setUniforms",value:function(t){var r=X(t);for(var e in r)r[e].type==="sampler2D"?this.loadTexture(r[e].name,r[e].value[0]):this.uniform(r[e].method,r[e].type,r[e].name,r[e].value);this.forceRender=!0}},{key:"setMouse",value:function(t){var r=this.canvas.getBoundingClientRect();if(t&&t.x&&t.x>=r.left&&t.x<=r.right&&t.y&&t.y>=r.top&&t.y<=r.bottom){var e=(t.x-r.left)*this.realToCSSPixels,i=this.canvas.height-(t.y-r.top)*this.realToCSSPixels;this.uniform("2f","vec2","u_mouse",e,i)}}},{key:"uniform",value:function(t,r,e){this.uniforms[e]=this.uniforms[e]||{};for(var i=this.uniforms[e],o=arguments.length,s=Array(o>3?o-3:0),u=3;u<o;u++)s[u-3]=arguments[u];var l=_e(i.value,s);if(l||this.change||!i.location||!i.value){i.name=e,i.type=r,i.value=s,i.method="uniform"+t,this.gl.useProgram(this.program),i.location=this.gl.getUniformLocation(this.program,e),this.gl[i.method].apply(this.gl,[i.location].concat(i.value));for(var h in this.buffers){var f=this.buffers[h];this.gl.useProgram(f.program);var d=this.gl.getUniformLocation(f.program,e);this.gl[i.method].apply(this.gl,[d].concat(i.value))}}}},{key:"uniformTexture",value:function(t,r,e){if(this.textures[t]===void 0)this.loadTexture(t,r,e);else{this.uniform("1i","sampler2D",t,this.texureIndex);for(var i in this.buffers){var o=this.buffers[i];this.gl.useProgram(o.program),this.gl.activeTexture(this.gl.TEXTURE0+this.texureIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures[t].texture)}this.gl.useProgram(this.program),this.gl.activeTexture(this.gl.TEXTURE0+this.texureIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures[t].texture),this.uniform("2f","vec2",t+"Resolution",this.textures[t].width,this.textures[t].height)}}},{key:"resize",value:function(){if(this.width!==this.canvas.clientWidth||this.height!==this.canvas.clientHeight){this.realToCSSPixels=window.devicePixelRatio||1;var t=Math.floor(this.gl.canvas.clientWidth*this.realToCSSPixels),r=Math.floor(this.gl.canvas.clientHeight*this.realToCSSPixels);return(this.gl.canvas.width!==t||this.gl.canvas.height!==r)&&(this.gl.canvas.width=t,this.gl.canvas.height=r,this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height)),this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.resizeSwappableBuffers(),!0}else return!1}},{key:"render",value:function(){if(this.visible=ye(this.canvas),this.forceRender||this.change||this.animated&&this.visible&&!this.paused){var t=new Date,r=performance.now();this.timeDelta=(r-this.timePrev)/1e3,this.timePrev=r,this.nDelta>1&&this.uniform("1f","float","u_delta",this.timeDelta),this.nTime>1&&this.uniform("1f","float","u_time",(r-this.timeLoad)/1e3),this.nDate&&this.uniform("4f","float","u_date",t.getFullYear(),t.getMonth(),t.getDate(),t.getHours()*3600+t.getMinutes()*60+t.getSeconds()+t.getMilliseconds()*.001),this.uniform("2f","vec2","u_resolution",this.canvas.width,this.canvas.height);for(var e in this.buffers){var i=this.buffers[e];this.uniform("1i","sampler2D",i.name,i.bundle.input.index)}this.texureIndex=this.BUFFER_COUNT;for(var o in this.textures)this.uniformTexture(o),this.texureIndex++;this.renderPrograms(),this.trigger("render",{}),this.change=!1,this.forceRender=!1}}},{key:"pause",value:function(){this.paused=!0}},{key:"play",value:function(){this.paused=!1}},{key:"renderPrograms",value:function(){var t=this.gl,r=t.canvas.width,e=t.canvas.height;t.viewport(0,0,r,e);for(var i in this.buffers){var o=this.buffers[i];o.bundle.render(r,e,o.program,o.name),t.bindFramebuffer(t.FRAMEBUFFER,null)}t.useProgram(this.program),t.drawArrays(t.TRIANGLES,0,6)}},{key:"getBuffers",value:function(t){var r={};return t&&t.replace(/(?:^\s*)((?:#if|#elif)(?:\s*)(defined\s*\(\s*BUFFER_)(\d+)(?:\s*\))|(?:#ifdef)(?:\s*BUFFER_)(\d+)(?:\s*))/gm,function(){var e=arguments[3]||arguments[4];r["u_buffer"+e]={fragment:"#define BUFFER_"+e+`
`+t}}),r}},{key:"loadPrograms",value:function(t){var r=this,e=this.gl,i=A(r,r.vertexString,e.VERTEX_SHADER);for(var o in t){var s=t[o],u=A(r,s.fragment,e.FRAGMENT_SHADER,1);u?r.isValid=!0:(u=A(r,`void main(){
	gl_FragColor = vec4(1.0);
}`,e.FRAGMENT_SHADER),r.isValid=!1);var l=j(r,[i,u]);s.name=o,s.program=l,s.bundle=r.createSwappableBuffer(r.canvas.width,r.canvas.height,l),e.deleteShader(u)}e.deleteShader(i)}},{key:"createSwappableBuffer",value:function(t,r,e){var i=this.createBuffer(t,r,e),o=this.createBuffer(t,r,e),s=this.gl;return{input:i,output:o,swap:function(){var l=i;i=o,o=l,this.input=i,this.output=o},render:function(l,h,f,d){s.useProgram(f),s.viewport(0,0,l,h),s.bindFramebuffer(s.FRAMEBUFFER,this.input.buffer),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,this.output.texture,0),s.drawArrays(s.TRIANGLES,0,6),this.swap()},resize:function(l,h,f,d){s.useProgram(f),s.viewport(0,0,l,h),this.input.resize(l,h),this.output.resize(l,h)}}}},{key:"createBuffer",value:function(t,r,e){var i=this.gl,o=this.BUFFER_COUNT;this.BUFFER_COUNT+=2,i.getExtension("OES_texture_float");var s=i.createTexture();i.activeTexture(i.TEXTURE0+o),i.bindTexture(i.TEXTURE_2D,s),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,r,0,i.RGBA,i.FLOAT,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);var u=i.createFramebuffer();return{index:o,texture:s,buffer:u,W:t,H:r,resize:function(h,f){i.bindFramebuffer(i.FRAMEBUFFER,u);var d=Math.min(h,this.W),c=Math.min(f,this.H),T=new Float32Array(d*c*4);i.readPixels(0,0,d,c,i.RGBA,i.FLOAT,T),i.bindFramebuffer(i.FRAMEBUFFER,null);var E=o+1,p=i.createTexture();i.activeTexture(i.TEXTURE0+E),i.bindTexture(i.TEXTURE_2D,p),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,h,f,0,i.RGBA,i.FLOAT,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,d,c,i.RGBA,i.FLOAT,T);var R=i.createFramebuffer();i.bindFramebuffer(i.FRAMEBUFFER,null),i.deleteTexture(s),i.activeTexture(i.TEXTURE0+o),i.bindTexture(i.TEXTURE_2D,p),o=this.index=o,s=this.texture=p,u=this.buffer=R,this.W=h,this.H=f}}}},{key:"resizeSwappableBuffers",value:function(){var t=this.gl,r=t.canvas.width,e=t.canvas.height;t.viewport(0,0,r,e);for(var i in this.buffers){var o=this.buffers[i];o.bundle.resize(r,e,o.program,o.name)}t.useProgram(this.program)}},{key:"version",value:function(){return"0.1.7"}}]),n}();function xe(){var n=document.getElementsByClassName("glslCanvas");if(n.length>0){window.glslCanvases=[];for(var a=0;a<n.length;a++){var t=new V(n[a]);t.isValid&&window.glslCanvases.push(t)}}}return window.addEventListener("load",function(){xe()}),V})});var z=Me(Y());console.log("Script Loaded");var Ce=document.getElementById("feather_canvas"),Q=new z.default(Ce);Q.setUniform("u_tex0","../assets/feather.jpg");var Ie=`
  #ifdef GL_ES
  precision mediump float;
  #endif

  uniform vec2 u_resolution;
  uniform vec2 u_mouse;
  uniform float u_time;

  uniform sampler2D u_tex0;
  uniform vec2 u_tex0Resolution;
  float random (in vec2 st) {
    return fract(sin(dot(st.xy,
                         vec2(12.9898,78.233)))*
        43758.5453123);
  }

    float noise (in vec2 st) {
      vec2 i = floor(st);
      vec2 f = fract(st);

      // Four corners in 2D of a tile
      float a = random(i);
      float b = random(i + vec2(1.0, 0.0));
      float c = random(i + vec2(0.0, 1.0));
      float d = random(i + vec2(1.0, 1.0));

      vec2 u = f * f * (3.0 - 2.0 * f);

      return mix(a, b, u.x) +
              (c - a)* u.y * (1.0 - u.x) +
              (d - b) * u.x * u.y;
  }  

  #define OCTAVES 6
  float fbm (in vec2 st) {
      // Initial values
      float value = 0.0;
      float amplitude = .5;
      float frequency = 0.;
      //
      // Loop of octaves
      for (int i = 0; i < OCTAVES; i++) {
          value += amplitude * noise(st);
          st *= 2.;
          amplitude *= .5;
      }
      return value;
  }

  void main(){
    vec2 st = gl_FragCoord.xy/u_tex0Resolution.xy;
    float edge = 0.8;
    float edge2 = st.y * 1.7;
    float s = smoothstep(u_mouse.y / st.y, 1.0, edge2);
    vec2 surface = s * vec2( 
        mix(-0.3, 0.3, fbm(st + u_time * 0.0075)), 
        mix(-0.3, 0.3, fbm(st + u_time * 0.0075))
    );
    st *= 1.7;
    st += refract(vec2(0.0, 0.0), surface, 1.0 / 1.33);
    vec4 color = vec4(st.x,st.y,0.0,0.0);
    color = texture2D(u_tex0,st);
    gl_FragColor = color;
  }
  `;Q.load(Ie);})();
